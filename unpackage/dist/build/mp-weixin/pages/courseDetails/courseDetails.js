(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/courseDetails/courseDetails"],{"03ea":function(t,e,o){},"3a00":function(t,e,o){"use strict";var n={uniPopup:function(){return Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup")]).then(o.bind(null,"5592"))}},i=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=t.$refs.sharePop.open,t.e1=t.$refs.popup1.close,t.e2=function(e){t.showAd=!1})},s=[];o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return n}))},5162:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup")]).then(function(){return resolve(o("5592"))}.bind(null,o)).catch(o.oe)},i=function(){o.e("components/Activity").then(function(){return resolve(o("be53"))}.bind(null,o)).catch(o.oe)},s=function(){o.e("components/CommentItem").then(function(){return resolve(o("2183"))}.bind(null,o)).catch(o.oe)},a={components:{uniPopup:n,Activity:i,CommentItem:s},data:function(){return{tmpImg:"",width:570,height:820,pixelRatio:2,codePath:"/static/tmp/code.jpg",poserImg:"https://t8.baidu.com/it/u=3887179165,3572970878&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1596352536&t=2736120db00abcf307212a6d5ddfce18",tagList:[],detail:{},top:22,scrollTop:0,showAd:!0,toIndex:"",letterDetails:[],currentLetter:"Details",type:0,recomedList:[],imgUrl:"",commentList:[],pageNo:1,showMask:!1}},onLoad:function(e){var o=this;this.imgUrl=this.$baseUrl,this.top=t.getMenuButtonBoundingClientRect().top,this.detail=getApp().globalData.courseData,this.getCates(),this.getCommentList(),this.getStudyContent(),e.type&&(this.type=e.type),t.getStorage({key:"notfirstStudy",success:function(t){o.showMask=!1},fail:function(t){o.showMask=!0}})},onShareAppMessage:function(t){return"button"===t.from&&console.log(t.target),{title:"自定义分享标题",path:"/pages/index/index"}},methods:{closeMask:function(){this.showMask=!1,t.setStorage({key:"notfirstStudy",data:"1",success:function(){console.log("success")}})},doCollected:function(){var e=this,o=0==this.detail.isStore?1:0;this.$api.post("/api/user/store",{type:2,status:o,tableId:this.detail.id,userId:t.getStorageSync("userInfo").id}).then((function(t){e.detail.isStore=o}))},getCates:function(){var t=this;this.$api.get("/api/static/dictList",{params:{type:2}}).then((function(e){var o="",n=[];e.data.forEach((function(e){e.id==t.detail.typeId&&(n.push(e.name),o=e.pid)})),console.log(n),e.data.forEach((function(t){t.id==o&&n.push(t.name)})),t.tagList=n}))},getCommentList:function(){var t=this;this.$api.get("/api/comment/getList",{params:{pageNo:this.pageNo,pageSize:5,tableId:this.detail.id,type:2}}).then((function(e){e.data.length>0&&(t.commentList=t.commentList.concat(e.data),t.pageNo++)}))},getStudyContent:function(){var t=this;this.$api.get("/api/lesson/getBookListByLessonId",{params:{lessonId:this.detail.id,type:1}}).then((function(e){t.recomedList=e.data}))},goEval:function(){t.navigateTo({url:"/pagesA/courseEvaluation/courseEvaluation"})},goBuy:function(){t.navigateTo({url:"/pages/courseBuy/courseBuy"})},toView:function(t){this.toIndex=t},scrollHandle:function(e){var o=this,n=e.detail.scrollTop;this.scrollTop=n,console.log(n);var i=t.createSelectorQuery().in(this).selectAll(".module");i.boundingClientRect((function(t){var e=t[0].top;console.log(t),t.forEach((function(t){t.top=t.top-e,t.bottom=t.bottom-e,o.letterDetails.push({id:t.id,top:t.top,bottom:t.bottom})})),o.letterDetails.some((function(t){if(n-180>=t.top&&n-180<=t.bottom-20)return o.currentLetter=t.id,!0})),console.log(o.currentLetter)})).exec()},goBack:function(){t.navigateBack({delta:1})},showGroupPop:function(){this.$refs.popup.open()},OpenGroup:function(){this.$refs.popup.close(),this.$refs.popup1.open()},viewAll:function(){t.navigateTo({url:"/pages/comment/comment"})},closePoser:function(){this.$refs.poster.close()},getPoster:function(){var e=this;this.$refs.sharePop.close(),t.showLoading({title:"海报生成中...",mask:!0});var o=this,n=wx.createCanvasContext("myCanvas");n.width=this.width,n.height=this.height;n.width;wx.getImageInfo({src:this.poserImg,success:function(i){n.fillStyle="#FFFFFF",n.fillRect(0,0,e.width,e.height),n.drawImage(i.path,0,0,e.width,530),n.setFontSize(28),n.setFillStyle("#000000"),n.setTextAlign("center");var s="杭州小记者内蒙古宁夏夏令营梦幻迪士尼";s.length>20&&(s=s.substr(0,20)+"..."),n.fillText(s,e.width/2,600);var a="长按识别，立即参加";n.setFontSize(28),n.fillText(a,320,760),n.save(),n.restore();var c="邀您参加";n.setFillStyle("#666666"),n.font="normal bold 24px sans-serif",n.fillText(c,340,720),n.save(),n.restore();var r="张雨溪";n.setFillStyle("#000000"),n.font="normal bold 26px sans-serif",n.fillText(r,340,690),n.save(),n.restore(),wx.getImageInfo({src:o.codePath,success:function(i){n.drawImage(o.codePath,33,650,132,132),wx.getImageInfo({src:e.poserImg,success:function(o){console.log(o);var i=62,s=62,a=200,c=660;n.beginPath(),n.arc(i/2+a,s/2+c,i/2,0,2*Math.PI,!1),n.clip(),n.drawImage(o.path,200,660,62,62),n.save(),n.draw(),setTimeout((function(){wx.canvasToTempFilePath({canvasId:"myCanvas",x:0,y:0,width:e.width,height:e.height,destWidth:e.width,destHeight:e.height,success:function(o){var n=o.tempFilePath;e.tmpImg=n,console.log(n),t.hideLoading(),e.$refs.poster.open()},fail:function(e){console.log(e),t.hideLoading()}})}),300)}})}})}})},saveImageToPhotosAlbum:function(){var t=this,e=t.tmpImg;void 0!=e&&""!=e&&wx.saveImageToPhotosAlbum({filePath:e,success:function(t){wx.showToast({title:"已保存到相册",icon:"none",duration:1500,mask:!0})},fail:function(t){console.error(t),console.error("打开设置窗口"),wx.openSetting({success:function(t){console.error(t),t.authSetting["scope.writePhotosAlbum"]?console.error("获取权限成功，再次点击图片保存到相册"):console.error("获取权限失败")}})}})}}};e.default=a}).call(this,o("543d")["default"])},"73c7":function(t,e,o){"use strict";(function(t){o("1f75");n(o("66fd"));var e=n(o("c6c3"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},b95e:function(t,e,o){"use strict";o.r(e);var n=o("5162"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},c6c3:function(t,e,o){"use strict";o.r(e);var n=o("3a00"),i=o("b95e");for(var s in i)"default"!==s&&function(t){o.d(e,t,(function(){return i[t]}))}(s);o("e334");var a,c=o("f0c5"),r=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);e["default"]=r.exports},e334:function(t,e,o){"use strict";var n=o("03ea"),i=o.n(n);i.a}},[["73c7","common/runtime","common/vendor"]]]);